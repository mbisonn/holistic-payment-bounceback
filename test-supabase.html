<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Supabase Connection Test</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script type="module">
    // Load environment variables from .env file
    const env = {
      VITE_SUPABASE_URL: 'https://ytqruetuadthefyclmiq.supabase.co',
      VITE_SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl0cXJ1ZXR1YWR0aGVmeWNsbWlxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NTg5OTIsImV4cCI6MjA2ODAzNDk5Mn0.aQ0KUyHmrm_mcZkMDT2QiOGH6dPfhH4tjbPZcH40IDI'
    };

    // Initialize Supabase
    const supabase = supabase.createClient(env.VITE_SUPABASE_URL, env.VITE_SUPABASE_ANON_KEY);

    async function testConnection() {
      const output = document.getElementById('output');
      
      try {
        output.innerHTML += '<p>Testing Supabase connection...</p>';
        
        // Test auth state
        const { data: { session }, error: sessionError } = await supabase.auth.getSession();
        output.innerHTML += `<p>Session: ${session ? 'Authenticated' : 'No active session'}</p>`;
        if (sessionError) output.innerHTML += `<p style="color: red;">Session error: ${sessionError.message}</p>`;

        // Test a simple query
        output.innerHTML += '<p>Testing products table...</p>';
        const { data: products, error: productsError } = await supabase
          .from('products')
          .select('*')
          .limit(3);

        if (productsError) {
          output.innerHTML += `<p style="color: red;">Products query error: ${productsError.message}</p>`;
        } else {
          output.innerHTML += `<p>Found ${products.length} products</p>`;
          products.forEach((product, index) => {
            output.innerHTML += `<p>${index + 1}. ${product.name || 'Unnamed product'}</p>`;
          });
        }

        output.innerHTML += '<p style="color: green;">Supabase connection test completed successfully!</p>';
      } catch (error) {
        output.innerHTML += `<p style="color: red;">Test failed: ${error.message}</p>`;
        console.error('Test error:', error);
      }
    }

    // Run the test when the page loads
    document.addEventListener('DOMContentLoaded', testConnection);
  </script>
</head>
<body>
  <h1>Supabase Connection Test</h1>
  <div id="output" style="font-family: monospace; white-space: pre;"></div>
</body>
</html>
